var util = require('util');
var Validator = Class.bind(null, 'Validator', Object);

Validator({
    constructor: function (definition) {
        this.parse(definition);
    },
    validate: function (data, callback) {
        var context = { errors: [], fields: {}, success: true};
        this.validator.validate(context, data, data, function (result) {
            context.success = result;

            callback(context, result);
        });
    },
    parse: function (definition) {
        // first build the local structure for the validation
        // aka crazy loop

        this.validator = new FieldValidator('^', definition);
    }
});